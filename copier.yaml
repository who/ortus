_min_copier_version: "9.0.0"

_jinja_extensions:
  - copier_templates_extensions.TemplateExtensionLoader
  - extensions/context.py:GitConfigContext
  - extensions/prerequisites.py:PrerequisiteChecker

_message_before_copy: |
  Welcome to Ortus â€” the origin of your next project.

  This will create a new project with:
  - Beads issue tracking
  - Claude Code configuration
  - Ralph loop automation
  - PRD templates

_message_after_copy: |
  Project created successfully!

  Starting project setup...

  (When complete, you'll need to `cd {{ _copier_conf.dst_path }}` to enter your project)

# =============================================================================
# Project Basics
# =============================================================================

project_name:
  type: str
  help: What is your project name? (lowercase, hyphens allowed)
  validator: >-
    {% if not project_name | regex_search('^[a-z][a-z0-9-]*$') %}
    Project name must be lowercase, start with a letter, and contain only letters, numbers, and hyphens.
    {% endif %}

project_description:
  type: str
  help: Short description of your project
  default: "A new project"

author_name:
  type: str
  help: Your name
  default: "{{ git_user_name }}"

author_email:
  type: str
  help: Your email
  default: "{{ git_user_email }}"

# =============================================================================
# Technology Stack
# =============================================================================

language:
  type: str
  help: Primary programming language
  choices:
    TypeScript: typescript
    Python: python
    Go: go
    Rust: rust
    Other: other
  default: typescript

package_manager:
  type: str
  help: Package manager to use
  choices: >-
    {% if language == 'typescript' %}
    {"bun": "bun", "npm": "npm", "pnpm": "pnpm", "yarn": "yarn", "None": "none"}
    {% elif language == 'python' %}
    {"uv": "uv", "pip": "pip", "None": "none"}
    {% elif language == 'go' %}
    {"go mod": "gomod", "None": "none"}
    {% elif language == 'rust' %}
    {"cargo": "cargo", "None": "none"}
    {% else %}
    {"None": "none"}
    {% endif %}
  default: >-
    {% if language == 'typescript' %}npm{% elif language == 'python' %}uv{% elif language == 'go' %}gomod{% elif language == 'rust' %}cargo{% else %}none{% endif %}
  when: "{{ language != 'other' }}"

framework:
  type: str
  help: Web framework (optional)
  choices: >-
    {% if language == 'typescript' %}
    {"Next.js": "nextjs", "Express": "express", "None": "none"}
    {% elif language == 'python' %}
    {"FastAPI": "fastapi", "Flask": "flask", "Django": "django", "None": "none"}
    {% elif language == 'go' %}
    {"Gin": "gin", "None": "none"}
    {% elif language == 'rust' %}
    {"Actix": "actix", "Axum": "axum", "None": "none"}
    {% else %}
    {"None": "none"}
    {% endif %}
  default: none
  when: "{{ language != 'other' }}"

linter:
  type: str
  help: Linter to use
  choices: >-
    {% if language == 'typescript' %}
    {"ESLint": "eslint", "None": "none"}
    {% elif language == 'python' %}
    {"ruff": "ruff", "None": "none"}
    {% elif language == 'go' %}
    {"golangci-lint": "golangci", "None": "none"}
    {% elif language == 'rust' %}
    {"clippy": "clippy", "None": "none"}
    {% else %}
    {"None": "none"}
    {% endif %}
  default: >-
    {% if language == 'typescript' %}eslint{% elif language == 'python' %}ruff{% elif language == 'go' %}golangci{% elif language == 'rust' %}clippy{% else %}none{% endif %}
  when: "{{ language != 'other' }}"

# =============================================================================
# Project Type
# =============================================================================

project_type:
  type: str
  help: What type of project is this?
  choices:
    API service (endpoints, schemas, auth): api
    CLI tool (commands, flags, I/O): cli
    Library/package (public API, versioning): library
    Full-stack app (frontend + backend): fullstack
    Other/Generic: other
  default: other

# =============================================================================
# Repository
# =============================================================================

github_username:
  type: str
  help: GitHub username or organization (for repo URL)
  default: ""

# =============================================================================
# PRD Intake
# =============================================================================

has_prd:
  type: bool
  help: Do you have a PRD (Product Requirements Document)?
  default: false

prd_path:
  type: str
  help: Path to your PRD file (will be copied into project)
  when: "{{ has_prd }}"

# =============================================================================
# Optional Features
# =============================================================================

license:
  type: str
  help: License for your project
  choices:
    MIT: MIT
    Apache 2.0: Apache-2.0
    GPL 3.0: GPL-3.0
    BSD 3-Clause: BSD-3-Clause
    Proprietary: proprietary
    None: none
  default: MIT

# =============================================================================
# Copier Settings
# =============================================================================

_subdirectory: template

_exclude:
  - copier.yaml
  - "*.pyc"
  - __pycache__
  - .git
  - .DS_Store

_skip_if_exists:
  - ".beads/*"

_tasks:
  - "chmod +x ortus/ralph.sh ortus/interview.sh ortus/idea.sh ortus/tail.sh"
  - "git init"
  - "bd init"
  - "bd setup claude"
  - "{{ 'cp \"' + prd_path + '\" prd/intake.md' if has_prd else 'true' }}"
  - "git add -A && git commit -m 'Initial commit from Ortus template'"
  - "./ortus/idea.sh"
